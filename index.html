<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>3학년 칭찬스티커판</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Malgun Gothic', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #ff6b6b, #ee5a24);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .stats {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 20px;
            border-bottom: 3px solid #e9ecef;
        }

        .stat-item {
            text-align: center;
            padding: 10px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            min-width: 150px;
        }

        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #ff6b6b;
        }

        .stat-label {
            color: #666;
            margin-top: 5px;
        }

        .class-tabs {
            display: flex;
            background: #e9ecef;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 30px;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1.1em;
            font-weight: bold;
            color: #666;
            transition: all 0.3s ease;
            white-space: nowrap;
        }

        .tab.active {
            background: white;
            color: #ff6b6b;
            border-bottom: 3px solid #ff6b6b;
        }

        .tab:hover {
            background: #f8f9fa;
        }

        .class-content {
            padding: 30px;
            display: none;
        }

        .class-content.active {
            display: block;
        }

        .class-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            padding: 20px;
            background: linear-gradient(135deg, #74b9ff, #0984e3);
            color: white;
            border-radius: 15px;
        }

        .class-title {
            font-size: 1.8em;
            font-weight: bold;
        }

        .class-total {
            font-size: 1.5em;
            font-weight: bold;
        }

        .students-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
        }

        .student-card {
            background: white;
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 2px solid transparent;
            transition: all 0.3s ease;
        }

        .student-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 35px rgba(0,0,0,0.15);
            border-color: #ff6b6b;
        }

        .student-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .student-name {
            font-size: 1.2em;
            font-weight: bold;
            color: #2d3436;
        }

        .student-number {
            background: #ddd6fe;
            color: #7c3aed;
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 0.9em;
            font-weight: bold;
        }

        .score-section {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .score-display {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .stars {
            color: #ffd700;
            font-size: 1.5em;
        }

        .score-number {
            font-size: 1.5em;
            font-weight: bold;
            color: #ff6b6b;
        }

        .score-controls {
            display: flex;
            gap: 10px;
        }

        .score-btn {
            width: 40px;
            height: 40px;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 1.2em;
            font-weight: bold;
            color: white;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .score-btn.plus {
            background: linear-gradient(135deg, #00b894, #00a085);
        }

        .score-btn.minus {
            background: linear-gradient(135deg, #e17055, #d63031);
        }

        .score-btn:hover {
            transform: scale(1.1);
        }

        .memo-section {
            margin-top: 15px;
        }

        .memo-input {
            width: 100%;
            padding: 10px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 0.9em;
            transition: border-color 0.3s ease;
        }

        .memo-input:focus {
            outline: none;
            border-color: #74b9ff;
        }

        .memo-list {
            margin-top: 10px;
            max-height: 150px;
            overflow-y: auto;
        }

        .memo-item {
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 8px;
            margin-bottom: 5px;
            font-size: 0.85em;
            border-left: 3px solid #74b9ff;
        }

        .memo-item.negative {
            border-left-color: #e17055;
        }

        .memo-date {
            color: #666;
            font-size: 0.8em;
        }

        .memo-text {
            margin-top: 3px;
        }

        .top-performers {
            background: linear-gradient(135deg, #fdcb6e, #e17055);
            color: white;
            padding: 25px;
            margin: 20px 0;
            border-radius: 15px;
            text-align: center;
        }

        .top-performers h3 {
            margin-bottom: 15px;
            font-size: 1.5em;
        }

        .top-list {
            display: flex;
            justify-content: center;
            gap: 30px;
            flex-wrap: wrap;
        }

        .top-item {
            background: rgba(255,255,255,0.2);
            padding: 15px;
            border-radius: 10px;
            backdrop-filter: blur(10px);
        }

        .crown {
            font-size: 2em;
            margin-bottom: 5px;
        }

        @media (max-width: 768px) {
            .students-grid {
                grid-template-columns: 1fr;
            }
            
            .class-tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                flex: 1;
                min-width: 100px;
            }
            
            .top-list {
                flex-direction: column;
                align-items: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🌟 3학년 칭찬스티커판 🌟</h1>
            <p>매달 최고의 반과 학생을 찾아보세요!</p>
        </div>

        <div class="stats">
            <div class="stat-item">
                <div class="stat-number" id="totalStudents">156</div>
                <div class="stat-label">전체 학생 수</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="totalStickers">0</div>
                <div class="stat-label">전체 스티커 수</div>
            </div>
            <div class="stat-item">
                <div class="stat-number" id="topClass">-</div>
                <div class="stat-label">1등 반</div>
            </div>
        </div>

        <div class="top-performers">
            <h3>🏆 이달의 TOP 3 🏆</h3>
            <div class="top-list" id="topPerformers">
                <div class="top-item">아직 기록이 없습니다</div>
            </div>
        </div>

        <div class="class-tabs">
            <button class="tab active" onclick="showClass('class1')">3학년 1반</button>
            <button class="tab" onclick="showClass('class2')">3학년 2반</button>
            <button class="tab" onclick="showClass('class3')">3학년 3반</button>
            <button class="tab" onclick="showClass('class4')">3학년 4반</button>
            <button class="tab" onclick="showClass('class5')">3학년 5반</button>
            <button class="tab" onclick="showClass('class6')">3학년 6반</button>
        </div>

        <div id="class1" class="class-content active">
            <div class="class-header">
                <div class="class-title">3학년 1반</div>
                <div class="class-total">반 총합: <span id="class1-total">0</span>점</div>
            </div>
            <div class="students-grid" id="students-class1"></div>
        </div>

        <div id="class2" class="class-content">
            <div class="class-header">
                <div class="class-title">3학년 2반</div>
                <div class="class-total">반 총합: <span id="class2-total">0</span>점</div>
            </div>
            <div class="students-grid" id="students-class2"></div>
        </div>

        <div id="class3" class="class-content">
            <div class="class-header">
                <div class="class-title">3학년 3반</div>
                <div class="class-total">반 총합: <span id="class3-total">0</span>점</div>
            </div>
            <div class="students-grid" id="students-class3"></div>
        </div>

        <div id="class4" class="class-content">
            <div class="class-header">
                <div class="class-title">3학년 4반</div>
                <div class="class-total">반 총합: <span id="class4-total">0</span>점</div>
            </div>
            <div class="students-grid" id="students-class4"></div>
        </div>

        <div id="class5" class="class-content">
            <div class="class-header">
                <div class="class-title">3학년 5반</div>
                <div class="class-total">반 총합: <span id="class5-total">0</span>점</div>
            </div>
            <div class="students-grid" id="students-class5"></div>
        </div>

        <div id="class6" class="class-content">
            <div class="class-header">
                <div class="class-title">3학년 6반</div>
                <div class="class-total">반 총합: <span id="class6-total">0</span>점</div>
            </div>
            <div class="students-grid" id="students-class6"></div>
        </div>
    </div>

    <script>
        // 학생 데이터
        const studentsData = {
            class1: [
                {number: 1, name: '간민준'}, {number: 2, name: '권예한'}, {number: 3, name: '김대한'}, 
                {number: 4, name: '김서정'}, {number: 5, name: '김선율'}, {number: 6, name: '김승민'}, 
                {number: 7, name: '김재원'}, {number: 8, name: '김정수'}, {number: 9, name: '김해원'}, 
                {number: 10, name: '남궁건'}, {number: 11, name: '노현승'}, {number: 13, name: '백서율'}, 
                {number: 14, name: '변성현'}, {number: 15, name: '송호근'}, {number: 16, name: '원상진'}, 
                {number: 17, name: '유동건'}, {number: 18, name: '윤혜성'}, {number: 19, name: '이시윤'}, 
                {number: 20, name: '정다검'}, {number: 21, name: '최근찬'}, {number: 22, name: '최시우'}, 
                {number: 23, name: '최시훈'}, {number: 24, name: '추정우'}, {number: 25, name: '한준희'}, 
                {number: 26, name: '허리원'}, {number: 27, name: '홍주호'}
            ],
            class2: [
                {number: 1, name: '강민재'}, {number: 2, name: '경덕규'}, {number: 3, name: '곽명석'}, 
                {number: 4, name: '구교원'}, {number: 5, name: '권유빈'}, {number: 6, name: '김재웅'}, 
                {number: 7, name: '김태수'}, {number: 8, name: '나승현'}, {number: 9, name: '노해일'}, 
                {number: 10, name: '박건휘'}, {number: 11, name: '박송우'}, {number: 12, name: '송인엽'}, 
                {number: 13, name: '안재홍'}, {number: 14, name: '윤서진'}, {number: 15, name: '이상준'}, 
                {number: 16, name: '이수한'}, {number: 17, name: '이승현'}, {number: 18, name: '정우진'}, 
                {number: 20, name: '지성정'}, {number: 21, name: '진연우'}, {number: 22, name: '차윤호'}, 
                {number: 23, name: '차은찬'}, {number: 24, name: '최재우'}, {number: 25, name: '최호영'}, 
                {number: 26, name: '하석주'}, {number: 27, name: '김동혁'}
            ],
            class3: [
                {number: 1, name: '길성호'}, {number: 2, name: '김민준'}, {number: 3, name: '김영준'}, 
                {number: 4, name: '김재신'}, {number: 5, name: '남승찬'}, {number: 6, name: '문주환'}, 
                {number: 7, name: '민정기'}, {number: 8, name: '박은찬'}, {number: 9, name: '박주혁'}, 
                {number: 10, name: '손영철'}, {number: 11, name: '손정훈'}, {number: 12, name: '송민제'}, 
                {number: 13, name: '심우주'}, {number: 14, name: '원준혁'}, {number: 15, name: '이낙연'}, 
                {number: 16, name: '이하윤'}, {number: 17, name: '장성욱'}, {number: 18, name: '전도윤'}, 
                {number: 19, name: '정명훈'}, {number: 20, name: '정서후'}, {number: 21, name: '정진섭'}, 
                {number: 22, name: '주현우'}, {number: 23, name: '최민준'}, {number: 24, name: '최우진'}, 
                {number: 25, name: '최인우'}, {number: 26, name: '한결'}
            ],
            class4: [
                {number: 1, name: '권지후'}, {number: 2, name: '김동후'}, {number: 3, name: '김민기'}, 
                {number: 4, name: '김유래'}, {number: 5, name: '김주영'}, {number: 6, name: '김주환'}, 
                {number: 7, name: '김준혁'}, {number: 8, name: '문정환'}, {number: 9, name: '박건호'}, 
                {number: 10, name: '박민찬'}, {number: 11, name: '서윤건'}, {number: 12, name: '원태연'}, 
                {number: 13, name: '이동규'}, {number: 14, name: '이루다'}, {number: 15, name: '이연수'}, 
                {number: 16, name: '이정민'}, {number: 17, name: '이정협'}, {number: 18, name: '이하율'}, 
                {number: 19, name: '최명규'}, {number: 20, name: '최민준'}, {number: 21, name: '최윤모'}, 
                {number: 22, name: '최윤호'}, {number: 23, name: '최준우'}, {number: 24, name: '하정민'}, 
                {number: 25, name: '허성빈'}, {number: 26, name: '홍현우'}
            ],
            class5: [
                {number: 1, name: '강승윤'}, {number: 2, name: '권기환'}, {number: 3, name: '길찬호'}, 
                {number: 4, name: '김문원'}, {number: 5, name: '김윤호'}, {number: 6, name: '김정후'}, 
                {number: 7, name: '김호인'}, {number: 8, name: '문현성'}, {number: 9, name: '박명재'}, 
                {number: 10, name: '박상진'}, {number: 11, name: '심문수'}, {number: 12, name: '유지성'}, 
                {number: 13, name: '이서우'}, {number: 14, name: '이시후'}, {number: 15, name: '이윤수'}, 
                {number: 16, name: '이충원'}, {number: 17, name: '이현도'}, {number: 18, name: '이효원'}, 
                {number: 19, name: '임정묵'}, {number: 20, name: '장준규'}, {number: 21, name: '정지환'}, 
                {number: 22, name: '최근우'}, {number: 23, name: '최은혁'}, {number: 24, name: '최태영'}, 
                {number: 25, name: '허은성'}, {number: 26, name: '홍해솔'}
            ],
            class6: [
                {number: 1, name: '강지호'}, {number: 2, name: '김관형'}, {number: 3, name: '김인성'}, 
                {number: 4, name: '김민준'}, {number: 5, name: '김정우'}, {number: 6, name: '김주원'}, 
                {number: 7, name: '김준수'}, {number: 8, name: '김형경'}, {number: 9, name: '서아현'}, 
                {number: 10, name: '서찬성'}, {number: 11, name: '송예준'}, {number: 12, name: '신은수'}, 
                {number: 13, name: '심우진'}, {number: 14, name: '윤세윤'}, {number: 15, name: '이가람'}, 
                {number: 16, name: '이동권'}, {number: 17, name: '이동선'}, {number: 18, name: '이율민'}, 
                {number: 19, name: '이준민'}, {number: 20, name: '이호현'}, {number: 21, name: '임종현'}, 
                {number: 22, name: '장민'}, {number: 23, name: '장현호'}, {number: 24, name: '정민혁'}, 
                {number: 25, name: '조하람'}, {number: 26, name: '최규화'}
            ]
        };

        // 데이터 변수
        let studentScores = {};
        let studentMemos = {};

        // 데이터 로드
        function loadData() {
            try {
                const savedScores = JSON.parse(localStorage.getItem('studentScores') || '{}');
                const savedMemos = JSON.parse(localStorage.getItem('studentMemos') || '{}');
                studentScores = savedScores;
                studentMemos = savedMemos;
            } catch (e) {
                studentScores = {};
                studentMemos = {};
            }
        }

        // 데이터 저장
        function saveData() {
            try {
                localStorage.setItem('studentScores', JSON.stringify(studentScores));
                localStorage.setItem('studentMemos', JSON.stringify(studentMemos));
            } catch (e) {
                console.log('저장 실패');
            }
        }

        // 별표 생성
        function getStars(score) {
            return '⭐'.repeat(Math.max(0, score));
        }

        // 반 전환
        function showClass(className) {
            document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.class-content').forEach(content => content.style.display = 'none');
            
            const targetTab = document.querySelector(`button[onclick="showClass('${className}')"]`);
            if (targetTab) targetTab.classList.add('active');
            
            const targetContent = document.getElementById(className);
            if (targetContent) targetContent.style.display = 'block';
        }

        // 점수 업데이트
        function updateScore(classNum, studentNum, change, memo) {
            const key = `class${classNum}-${studentNum}`;
            
            if (!studentScores[key]) studentScores[key] = 0;
            if (!studentMemos[key]) studentMemos[key] = [];

            studentScores[key] += change;
            
            if (memo && memo.trim()) {
                studentMemos[key].push({
                    date: new Date().toLocaleString('ko-KR'),
                    text: memo,
                    change: change,
                    recorder: '선생님'
                });
            }

            updateDisplay();
            saveData();
        }

        // 화면 업데이트
        function updateDisplay() {
            // 모든 학생 카드 업데이트
            Object.keys(studentsData).forEach(className => {
                const classNum = className.replace('class', '');
                studentsData[className].forEach(student => {
                    updateStudentCard(classNum, student.number);
                });
                updateClassTotal(classNum);
            });
            
            updateStats();
            updateTopPerformers();
        }

        // 학생 카드 업데이트
        function updateStudentCard(classNum, studentNum) {
            const key = `class${classNum}-${studentNum}`;
            const score = studentScores[key] || 0;
            const memos = studentMemos[key] || [];

            const scoreEl = document.getElementById(`score-${key}`);
            const starsEl = document.getElementById(`stars-${key}`);
            const memosEl = document.getElementById(`memos-${key}`);

            if (scoreEl) scoreEl.textContent = score;
            if (starsEl) starsEl.textContent = getStars(score);
            
            if (memosEl) {
                memosEl.innerHTML = memos.slice(-3).map(memo => {
                    const sign = memo.change > 0 ? '+' : '';
                    const negClass = memo.change < 0 ? 'negative' : '';
                    return `<div class="memo-item ${negClass}">
                        <div class="memo-date">${memo.date} (${memo.recorder})</div>
                        <div class="memo-text">${sign}${memo.change}점: ${memo.text}</div>
                    </div>`;
                }).join('');
            }
        }

        // 반 총합 업데이트
        function updateClassTotal(classNum) {
            const students = studentsData[`class${classNum}`];
            let total = 0;
            
            students.forEach(student => {
                const key = `class${classNum}-${student.number}`;
                total += studentScores[key] || 0;
            });

            const totalEl = document.getElementById(`class${classNum}-total`);
            if (totalEl) totalEl.textContent = total;
        }

        // 전체 통계 업데이트
        function updateStats() {
            let totalStickers = 0;
            let classTotals = {};

            for (let i = 1; i <= 6; i++) {
                let classTotal = 0;
                const students = studentsData[`class${i}`];
                
                students.forEach(student => {
                    const score = studentScores[`class${i}-${student.number}`] || 0;
                    totalStickers += score;
                    classTotal += score;
                });
                
                classTotals[i] = classTotal;
            }

            const topClass = Object.keys(classTotals).reduce((a, b) => 
                classTotals[a] > classTotals[b] ? a : b
            );

            document.getElementById('totalStickers').textContent = totalStickers;
            document.getElementById('topClass').textContent = 
                classTotals[topClass] > 0 ? `3-${topClass}반` : '-';
        }

        // 상위 학생 업데이트
        function updateTopPerformers() {
            let allStudents = [];

            for (let i = 1; i <= 6; i++) {
                studentsData[`class${i}`].forEach(student => {
                    const score = studentScores[`class${i}-${student.number}`] || 0;
                    if (score > 0) {
                        allStudents.push({
                            name: student.name,
                            score: score,
                            class: i,
                            number: student.number
                        });
                    }
                });
            }

            allStudents.sort((a, b) => b.score - a.score);
            const top3 = allStudents.slice(0, 3);
            const crowns = ['👑', '🥈', '🥉'];

            const html = top3.length > 0 ? 
                top3.map((student, idx) => `
                    <div class="top-item">
                        <div class="crown">${crowns[idx]}</div>
                        <div><strong>${student.name}</strong></div>
                        <div>3-${student.class}반 ${student.number}번</div>
                        <div>${student.score}점 ⭐</div>
                    </div>
                `).join('') : 
                '<div class="top-item">아직 기록이 없습니다</div>';

            document.getElementById('topPerformers').innerHTML = html;
        }

        // 학생 카드 생성
        function createStudentCards() {
            Object.keys(studentsData).forEach(className => {
                const classNum = className.replace('class', '');
                const container = document.getElementById(`students-${className}`);
                
                const cards = studentsData[className].map(student => {
                    const key = `class${classNum}-${student.number}`;
                    return `
                        <div class="student-card">
                            <div class="student-info">
                                <div class="student-name">${student.name}</div>
                                <div class="student-number">${student.number}번</div>
                            </div>
                            <div class="score-section">
                                <div class="score-display">
                                    <div class="stars" id="stars-${key}">⭐</div>
                                    <div class="score-number" id="score-${key}">0</div>
                                </div>
                                <div class="score-controls">
                                    <button class="score-btn plus" onclick="addPoint(${classNum}, ${student.number})">+</button>
                                    <button class="score-btn minus" onclick="subtractPoint(${classNum}, ${student.number})">-</button>
                                </div>
                            </div>
                            <div class="memo-section">
                                <input type="text" class="memo-input" 
                                       placeholder="점수 변경 이유를 입력하세요..." 
                                       id="memo-input-${key}">
                                <div class="memo-list" id="memos-${key}"></div>
                            </div>
                        </div>
                    `;
                }).join('');
                
                container.innerHTML = cards;
            });
        }

        // 점수 추가
        function addPoint(classNum, studentNum) {
            const key = `class${classNum}-${studentNum}`;
            const memoInput = document.getElementById(`memo-input-${key}`);
            const memo = memoInput ? memoInput.value.trim() : '';
            
            updateScore(classNum, studentNum, 1, memo);
            
            if (memoInput) memoInput.value = '';
        }

        // 점수 감소
        function subtractPoint(classNum, studentNum) {
            const key = `class${classNum}-${studentNum}`;
            const memoInput = document.getElementById(`memo-input-${key}`);
            const memo = memoInput ? memoInput.value.trim() : '';
            
            updateScore(classNum, studentNum, -1, memo);
            
            if (memoInput) memoInput.value = '';
        }

        // 초기화
        function init() {
            loadData();
            createStudentCards();
            updateDisplay();
        }

        // 이벤트 리스너
        window.addEventListener('load', init);
        window.addEventListener('beforeunload', saveData);
        setInterval(saveData, 5000);
    </script>
</body>
</html>
